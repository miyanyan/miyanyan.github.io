<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="最近正在使用Qt的QOpenGLWidget来学习opengl，前期进展十分顺利，直到我遇到了framebuffer这一章节 framebuffer的大致使用方式如下：\n"><title>【Qt】glBindFramebuffer(GL_FRAMEBUFFER, 0) 导致屏幕空白的问题</title><link rel=canonical href=https://miyan.site/p/qtglbindframebuffergl_framebuffer-0-%E5%AF%BC%E8%87%B4%E5%B1%8F%E5%B9%95%E7%A9%BA%E7%99%BD%E7%9A%84%E9%97%AE%E9%A2%98/><link rel=stylesheet href=/scss/style.min.b77818f765fe979a22ec8a10bfc3b21fda3579333df699f64665b449773f177a.css><meta property='og:title' content="【Qt】glBindFramebuffer(GL_FRAMEBUFFER, 0) 导致屏幕空白的问题"><meta property='og:description' content="最近正在使用Qt的QOpenGLWidget来学习opengl，前期进展十分顺利，直到我遇到了framebuffer这一章节 framebuffer的大致使用方式如下：\n"><meta property='og:url' content='https://miyan.site/p/qtglbindframebuffergl_framebuffer-0-%E5%AF%BC%E8%87%B4%E5%B1%8F%E5%B9%95%E7%A9%BA%E7%99%BD%E7%9A%84%E9%97%AE%E9%A2%98/'><meta property='og:site_name' content='miyan的博客'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:published_time' content='2021-08-12T00:00:00+00:00'><meta property='article:modified_time' content='2025-05-12T21:47:50+08:00'><meta name=twitter:title content="【Qt】glBindFramebuffer(GL_FRAMEBUFFER, 0) 导致屏幕空白的问题"><meta name=twitter:description content="最近正在使用Qt的QOpenGLWidget来学习opengl，前期进展十分顺利，直到我遇到了framebuffer这一章节 framebuffer的大致使用方式如下：\n"><link rel="shortcut icon" href=/favicon.svg></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"dark")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=切换菜单>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu_b3b280c13e06dfac.png width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>miyan的博客</a></h1><h2 class=site-description>可以什么都不会，不能不会躺下来感受幸福</h2></div></header><ol class=menu-social><li><a href=https://github.com/miyanyan target=_blank title=GitHub rel=me><!doctype html><svg t="1713884694671" class="icon" viewBox="0 0 1024 1024" p-id="9399" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><path d="M64 512c0 195.2 124.8 361.6 300.8 422.4 22.4 6.4 19.2-9.6 19.2-22.4v-76.8c-134.4 16-140.8-73.6-150.4-89.6-19.2-32-60.8-38.4-48-54.4 32-16 64 3.2 99.2 57.6 25.6 38.4 76.8 32 105.6 25.6 6.4-22.4 19.2-44.8 35.2-60.8C281.6 691.2 224 604.8 224 502.4c0-48 16-96 48-131.2-22.4-60.8.0-115.2 3.2-121.6 57.6-6.4 118.4 41.6 124.8 44.8 32-9.6 70.4-12.8 112-12.8s80 6.4 112 12.8c12.8-9.6 67.2-48 121.6-44.8 3.2 6.4 25.6 57.6 6.4 118.4 32 38.4 48 83.2 48 131.2.0 102.4-57.6 188.8-201.6 214.4 22.4 22.4 38.4 54.4 38.4 92.8v112c0 9.6.0 19.2 16 19.2C832 876.8 960 710.4 960 512c0-246.4-201.6-448-448-448S64 265.6 64 512z" fill="#040000" p-id="9400"/></svg></a></li><li><a href=https://leetcode.cn/u/miyanyanyan/ target=_blank title=Leetcode rel=me><!doctype html><svg t="1713884461345" class="icon" viewBox="0 0 1024 1024" p-id="4333" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><path d="M701.28 766.86a58.9 58.9.0 0183.1 83.52l-102.24 102c-94.3 94.16-248 95.52-344 3.16-.56-.52-43.26-42.4-184.12-180.54-93.72-92-103.06-238.94-14.88-333.36l164.44-176C391.12 172 552.46 161.68 652.54 242.6l149.34 120.78a58.92 58.92.0 01-74 91.76L578.54 334.36c-52.34-42.34-144-36.52-189.06 11.84l-164.44 176c-42.94 46-38.22 120 11.26 168.54l183.26 179.7c49.86 48 130.48 47.3 179.42-1.58z" fill="#FFA116" p-id="4334"/><path d="M452.94 664.7a58.96 58.96.0 010-118h434a58.96 58.96.0 010 118z" fill="#B3B3B3" p-id="4335"/><path d="M534.22 18.68a58.9 58.9.0 1186 80.56L225.1 522.28c-42.92 46-38.22 120 11.24 168.54l182.46 178.9A58.92 58.92.0 01336.46 954L154.06 775.08c-93.7-92-103.04-238.94-14.84-333.36z" p-id="4336"/></svg></a></li><li><a href=https://www.zhihu.com/people/li-xiao-yan-98-60 target=_blank title=Zhihu rel=me><svg viewBox="51.20000000000002 51.2 921.6 921.6" width="2500" height="2500"><path fill="#06F" d="M656.906 724.29l47.422-33.725h52.69V344.9h-143.32v346.726h35.83z"/><path fill="#06F" d="M849.92 51.2H174.08c-67.866.0-122.88 55.014-122.88 122.88v675.84c0 67.866 55.014 122.88 122.88 122.88h675.84c67.866.0 122.88-55.014 122.88-122.88V174.08c0-67.866-55.014-122.88-122.88-122.88zM495.662 803.348l-101.171-157.05 44.267-31.616 67.451 98.007c-.005.0 23.179 37.995-10.547 90.66zm38.994-276.1v25.292H408.197C357.612 876.068 204.8 807.045 204.8 807.045 344.965 697.18 347.597 552.54 347.597 552.54H208.492c0-57.958 52.162-56.914 52.162-56.914h93.793V343.87h-50.585c-18.965 85.366-99.062 81.152-99.062 81.152s32.67-50.585 54.8-137c22.128-86.421 89.574-76.929 89.574-76.929-20.02 35.83-29.507 76.928-29.507 76.928H485.12c40.049.0 37.94 25.293 37.94 25.293v29.512H411.355v152.806h91.684c33.725.0 31.616 31.616 31.616 31.616zM819.2 747.5H716.974l-88.52 55.848-8.427-55.848h-64.292V288.015H819.2V747.5z"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>主页</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>归档</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>搜索</span></a></li><li><a href=/%E9%93%BE%E6%8E%A5/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>链接</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>暗色模式</span></li></ol></li></ol></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/computer-graphics/>Computer-Graphics</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/qtglbindframebuffergl_framebuffer-0-%E5%AF%BC%E8%87%B4%E5%B1%8F%E5%B9%95%E7%A9%BA%E7%99%BD%E7%9A%84%E9%97%AE%E9%A2%98/>【Qt】glBindFramebuffer(GL_FRAMEBUFFER, 0) 导致屏幕空白的问题</a></h2></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>2021-08-12</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>阅读时长: 3 分钟</time></div></footer></div></header><section class=article-content><p>最近正在使用Qt的QOpenGLWidget来学习opengl，前期进展十分顺利，直到我遇到了<a class=link href=https://learnopengl.com/Advanced-OpenGL/Framebuffers target=_blank rel=noopener>framebuffer</a>这一章节
framebuffer的大致使用方式如下：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c++ data-lang=c++><span class=line><span class=cl><span class=c1>// 创建FBO
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kt>unsigned</span> <span class=kt>int</span> <span class=n>framebuffer</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>glGenFramebuffers</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>framebuffer</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=n>glBindFramebuffer</span><span class=p>(</span><span class=n>GL_FRAMEBUFFER</span><span class=p>,</span> <span class=n>framebuffer</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=c1>// create a color attachment texture
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kt>unsigned</span> <span class=kt>int</span> <span class=n>textureColorbuffer</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>glGenTextures</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>textureColorbuffer</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=n>glBindTexture</span><span class=p>(</span><span class=n>GL_TEXTURE_2D</span><span class=p>,</span> <span class=n>textureColorbuffer</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=n>glTexImage2D</span><span class=p>(</span><span class=n>GL_TEXTURE_2D</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=n>GL_RGB</span><span class=p>,</span> <span class=n>SCR_WIDTH</span><span class=p>,</span> <span class=n>SCR_HEIGHT</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=n>GL_RGB</span><span class=p>,</span> <span class=n>GL_UNSIGNED_BYTE</span><span class=p>,</span> <span class=nb>NULL</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=n>glTexParameteri</span><span class=p>(</span><span class=n>GL_TEXTURE_2D</span><span class=p>,</span> <span class=n>GL_TEXTURE_MIN_FILTER</span><span class=p>,</span> <span class=n>GL_LINEAR</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=n>glTexParameteri</span><span class=p>(</span><span class=n>GL_TEXTURE_2D</span><span class=p>,</span> <span class=n>GL_TEXTURE_MAG_FILTER</span><span class=p>,</span> <span class=n>GL_LINEAR</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=n>glFramebufferTexture2D</span><span class=p>(</span><span class=n>GL_FRAMEBUFFER</span><span class=p>,</span> <span class=n>GL_COLOR_ATTACHMENT0</span><span class=p>,</span> <span class=n>GL_TEXTURE_2D</span><span class=p>,</span> <span class=n>textureColorbuffer</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=c1>// create a renderbuffer object for depth and stencil attachment (we won&#39;t be sampling these)
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kt>unsigned</span> <span class=kt>int</span> <span class=n>rbo</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>glGenRenderbuffers</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>rbo</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=n>glBindRenderbuffer</span><span class=p>(</span><span class=n>GL_RENDERBUFFER</span><span class=p>,</span> <span class=n>rbo</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=n>glRenderbufferStorage</span><span class=p>(</span><span class=n>GL_RENDERBUFFER</span><span class=p>,</span> <span class=n>GL_DEPTH24_STENCIL8</span><span class=p>,</span> <span class=n>SCR_WIDTH</span><span class=p>,</span> <span class=n>SCR_HEIGHT</span><span class=p>);</span> <span class=c1>// use a single renderbuffer object for both a depth AND stencil buffer.
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>glFramebufferRenderbuffer</span><span class=p>(</span><span class=n>GL_FRAMEBUFFER</span><span class=p>,</span> <span class=n>GL_DEPTH_STENCIL_ATTACHMENT</span><span class=p>,</span> <span class=n>GL_RENDERBUFFER</span><span class=p>,</span> <span class=n>rbo</span><span class=p>);</span> <span class=c1>// now actually attach it
</span></span></span><span class=line><span class=cl><span class=c1>// now that we actually created the framebuffer and added all attachments we want to check if it is actually complete now
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>if</span> <span class=p>(</span><span class=n>glCheckFramebufferStatus</span><span class=p>(</span><span class=n>GL_FRAMEBUFFER</span><span class=p>)</span> <span class=o>!=</span> <span class=n>GL_FRAMEBUFFER_COMPLETE</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=s>&#34;ERROR::FRAMEBUFFER:: Framebuffer is not complete!&#34;</span> <span class=o>&lt;&lt;</span> <span class=n>endl</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>glBindFramebuffer</span><span class=p>(</span><span class=n>GL_FRAMEBUFFER</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 第一处理阶段(Pass)
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>glBindFramebuffer</span><span class=p>(</span><span class=n>GL_FRAMEBUFFER</span><span class=p>,</span> <span class=n>framebuffer</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=n>glClearColor</span><span class=p>(</span><span class=mf>0.1f</span><span class=p>,</span> <span class=mf>0.1f</span><span class=p>,</span> <span class=mf>0.1f</span><span class=p>,</span> <span class=mf>1.0f</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=n>glClear</span><span class=p>(</span><span class=n>GL_COLOR_BUFFER_BIT</span> <span class=o>|</span> <span class=n>GL_DEPTH_BUFFER_BIT</span><span class=p>);</span> <span class=c1>// 我们现在不使用模板缓冲
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>glEnable</span><span class=p>(</span><span class=n>GL_DEPTH_TEST</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=n>DrawScene</span><span class=p>();</span>    
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 第二处理阶段
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>glBindFramebuffer</span><span class=p>(</span><span class=n>GL_FRAMEBUFFER</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span> <span class=c1>// 返回默认
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>glClearColor</span><span class=p>(</span><span class=mf>1.0f</span><span class=p>,</span> <span class=mf>1.0f</span><span class=p>,</span> <span class=mf>1.0f</span><span class=p>,</span> <span class=mf>1.0f</span><span class=p>);</span> 
</span></span><span class=line><span class=cl><span class=n>glClear</span><span class=p>(</span><span class=n>GL_COLOR_BUFFER_BIT</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>screenShader</span><span class=p>.</span><span class=n>use</span><span class=p>();</span>  
</span></span><span class=line><span class=cl><span class=n>glBindVertexArray</span><span class=p>(</span><span class=n>quadVAO</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=n>glDisable</span><span class=p>(</span><span class=n>GL_DEPTH_TEST</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=n>glBindTexture</span><span class=p>(</span><span class=n>GL_TEXTURE_2D</span><span class=p>,</span> <span class=n>textureColorbuffer</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=n>glDrawArrays</span><span class=p>(</span><span class=n>GL_TRIANGLES</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>6</span><span class=p>);</span>  
</span></span></code></pre></div><p>程序很简单，但是当我运行之后，发现屏幕全白，即对应<code>glClearColor(1.0f, 1.0f, 1.0f, 1.0f)</code>，为了验证我这个猜想，我进行了以下步骤：</p><ul><li>屏幕全白是不是真的对应到glClearColor这个函数。修改清屏颜色，发现运行后的屏幕颜色确实和其一一对应。</li><li>有没有真的把三角形绘制上去。把<code>glDrawArrays(GL_TRIANGLES, 0, 6)</code>删除后，发现并不影响<strong>屏幕全白</strong>这一结果，因此问题应该出现在<code>glClearColor(1.0f, 1.0f, 1.0f, 1.0f)</code>之前。</li><li>删除<strong>第二处理阶段</strong>的这几行代码，发现屏幕变黑，对应<code>glClearColor(0.1f, 0.1f, 0.1f, 1.0f)</code>，再把<code>glBindFramebuffer(GL_FRAMEBUFFER, framebuffer)</code>注释掉，让物体不绘制在帧缓冲内，而是直接绘制到当前屏幕上，嘿，没问题！</li></ul><p>那……问题应该是出现在帧缓冲绑定上？我们是否真的绑定到了帧缓冲区呢？
stackoverflow搜索一波：
<a class=link href=https://stackoverflow.com/questions/53693579/opengl-qt-problem-using-framebuffers-for-bloom-effect target=_blank rel=noopener>OpenGL Qt : problem using framebuffers for bloom effect</a>
<a class=link href=https://stackoverflow.com/questions/42455918/opengl-does-not-render-to-screen-by-calling-glbindframebuffergl-framebuffer-0 target=_blank rel=noopener>OpenGL does not render to screen by calling glBindFramebuffer(GL_FRAMEBUFFER,0)</a>
<a class=link href=https://stackoverflow.com/questions/31323749/easiest-way-for-offscreen-rendering-with-qopenglwidget target=_blank rel=noopener>Easiest way for offscreen rendering with QOpenGLWidget</a></p><p>果真是缓冲区绑定的问题！当我们执行<code>glBindFramebuffer(GL_FRAMEBUFFER, 0)</code>时，我们并没有返回到Qt默认的帧缓冲，应该先调用<code>QOpenGLContext::defaultFramebufferObject()</code>这个函数得到Qt默认的帧缓冲，</p><blockquote><p>Call this to get the default framebuffer object for the current surface.
On some platforms (for instance, iOS) the default framebuffer object depends on the surface being rendered to, and might be different from 0. Thus, instead of calling glBindFramebuffer(0), you should call glBindFramebuffer(ctx->defaultFramebufferObject()) if you want your application to work across different Qt platforms.
If you use the glBindFramebuffer() in QOpenGLFunctions you do not have to worry about this, as it automatically binds the current context&rsquo;s defaultFramebufferObject() when 0 is passed.
Note: Widgets that render via framebuffer objects, like QOpenGLWidget and QQuickWidget, will override the value returned from this function when painting is active, because at that time the correct &ldquo;default&rdquo; framebuffer is the widget&rsquo;s associated backing framebuffer, not the platform-specific one belonging to the top-level window&rsquo;s surface. This ensures the expected behavior for this function and other classes relying on it (for example, QOpenGLFramebufferObject::bindDefault() or QOpenGLFramebufferObject::release()).
See also QOpenGLFramebufferObject.</p></blockquote><p>即需要这么改：
<code>glBindFramebuffer(GL_FRAMEBUFFER, defaultFramebufferObject());</code></p><p>修改完之后，终于把这个问题解决啦！</p><p>当然，我们可以使用qt封装好的QOpenGLFramebufferObject类，这样代码更加简洁：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c++ data-lang=c++><span class=line><span class=cl><span class=c1>// 创建FBO
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>m_FBO</span> <span class=o>=</span> <span class=n>std</span><span class=o>::</span><span class=n>make_unique</span><span class=o>&lt;</span><span class=n>QOpenGLFramebufferObject</span><span class=o>&gt;</span><span class=p>(</span><span class=k>this</span><span class=o>-&gt;</span><span class=n>size</span><span class=p>(),</span> <span class=n>QOpenGLFramebufferObject</span><span class=o>::</span><span class=n>CombinedDepthStencil</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 第一处理阶段(Pass)
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>m_FBO</span><span class=o>-&gt;</span><span class=n>bind</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=n>glClearColor</span><span class=p>(</span><span class=mf>0.1f</span><span class=p>,</span> <span class=mf>0.1f</span><span class=p>,</span> <span class=mf>0.1f</span><span class=p>,</span> <span class=mf>1.0f</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=n>glClear</span><span class=p>(</span><span class=n>GL_COLOR_BUFFER_BIT</span> <span class=o>|</span> <span class=n>GL_DEPTH_BUFFER_BIT</span><span class=p>);</span> <span class=c1>// 我们现在不使用模板缓冲
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>glEnable</span><span class=p>(</span><span class=n>GL_DEPTH_TEST</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=n>DrawScene</span><span class=p>();</span>    
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 第二处理阶段
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>m_FBO</span><span class=o>-&gt;</span><span class=n>release</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=n>glClearColor</span><span class=p>(</span><span class=mf>1.0f</span><span class=p>,</span> <span class=mf>1.0f</span><span class=p>,</span> <span class=mf>1.0f</span><span class=p>,</span> <span class=mf>1.0f</span><span class=p>);</span> 
</span></span><span class=line><span class=cl><span class=n>glClear</span><span class=p>(</span><span class=n>GL_COLOR_BUFFER_BIT</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>screenShader</span><span class=p>.</span><span class=n>use</span><span class=p>();</span>  
</span></span><span class=line><span class=cl><span class=n>glBindVertexArray</span><span class=p>(</span><span class=n>quadVAO</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=n>glDisable</span><span class=p>(</span><span class=n>GL_DEPTH_TEST</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=n>glBindTexture</span><span class=p>(</span><span class=n>GL_TEXTURE_2D</span><span class=p>,</span> <span class=n>m_FBO</span><span class=o>-&gt;</span><span class=n>texture</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=n>glDrawArrays</span><span class=p>(</span><span class=n>GL_TRIANGLES</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>6</span><span class=p>);</span>  
</span></span></code></pre></div><p>我使用QOpenGLWidget学习opengl的代码放在github上了，欢迎访问~ <a class=link href=https://github.com/miyanyan/learnopengl-qt target=_blank rel=noopener>miyanyan/learnopengl-qt</a></p></section><footer class=article-footer><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section><section class=article-lastmod><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<span>最后更新于 2025-05-12 21:47:50</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>相关文章</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/p/opengl-4.5-%E7%9A%84-vaovboibo%E5%86%99%E6%B3%95/><div class=article-details><h2 class=article-title>OpenGL 4.5+ 的 VAO、VBO、IBO写法</h2></div></a></article></div></div></aside><script src=https://giscus.app/client.js data-repo=miyanyan/miyanyan.github.io data-repo-id=R_kgDOOg52Pg data-category=Announcements data-category-id=DIC_kwDOOg52Ps4CpjZF data-mapping=title data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=top data-theme=light data-lang=en data-loading crossorigin=anonymous async></script><script>function setGiscusTheme(e){let t=document.querySelector("iframe.giscus-frame");t&&t.contentWindow.postMessage({giscus:{setConfig:{theme:e}}},"https://giscus.app")}(function(){addEventListener("message",t=>{if(event.origin!=="https://giscus.app")return;e()}),window.addEventListener("onColorSchemeChange",e);function e(){setGiscusTheme(document.documentElement.dataset.scheme==="light"?"light":"dark_dimmed")}})()</script><footer class=site-footer><section class=copyright>&copy;
2020 -
2025 miyan的博客</section><section class=powerby>网站总访客数：<span id=busuanzi_value_site_uv>Loading</span><br>网站总访问量：<span id=busuanzi_value_site_pv>Loading</span><br>使用 <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> 构建<br>主题 <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.31.0>Stack</a></b> 由 <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> 设计</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script><div id=particles-js></div><script src=/background/particles.min.js></script><script>particlesJS.load("particles-js","/background/particlesjs-config.json",function(){console.log("particles.js loaded - callback")})</script><style>#particles-js{position:fixed;top:0;left:0;width:100%;z-index:-1}</style><script defer src=https://cn.vercount.one/js></script><style>@font-face{font-family:maplemono2;src:url(https://miyan.site/font/MapleMono2.ttf)format('truetype')}:root{--base-font-family:'MapleMono2';--code-font-family:'MapleMono2'}</style></body></html>